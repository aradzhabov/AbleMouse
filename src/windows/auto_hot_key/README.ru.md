# MouseCommander — Быстрые действия, управляемые жестами мыши

> Этот подход был разработан в ответ на запросы людей с ограниченными возможностями, использующих Windows, чтобы упростить и ускорить их рабочий процесс. Он специально предназначен для тех, кто может управлять только указателем мыши (без использования обычной мыши) и не может пользоваться клавиатурой. Решение позволяет быстро перемещаться к нужным точкам экрана, вызывать экранный клавиатуру (OSK) и позиционировать курсор внутри неё, а также упрощает наведение на конкретные точки с помощью прицельной сетки.
> 
> Подход легко переводится на любой язык и расширяется дополнительными функциями по мере необходимости.
> 
> Ниже приведён подробный рабочий пример скрипта. Используя его как основу, вы можете разработать собственный жест и персонализированный набор доступных команд, которые наилучшим образом соответствуют вашим потребностям.

## Обзор
> ▶️ [пример вызова меню при использовании AbleMouse AI edition](https://rutube.ru/video/c27362a9037dbe7b9ceb7fb06f275b4c/?r=wd&t=69)
> 
> ▶️ [демонстрация возможностей](https://rutube.ru/video/83b28184f3693f3217fb0cab863da98a/)
> 
Скрипт автоматизации на основе жестов, распознающий движения мыши (влево → вправо) как пример для отображения панели быстрого доступа с различными системными функциями.

![Скриншот](./media/mouse_commander_screenshot.png)

## Исходный код
[mouse_commander.ahk](./mouse_%D1%81ommander.ahk)

## Возможности
- Распознавание жестов мыши (движение влево → вправо)
- Панель быстрого доступа с настраиваемыми действиями
- **osk hide/show**: Переключение видимости экранный клавиатуры
- **osk to cursor**: вызов экранной клавиатуры и фокусировка курсора на ней
- **mouse jump**: Мгновенный переход указателя мыши в любую точку рабочего стола
- **crosshair**: Переключение прицельной сетки поверх экрана
- Возможность самостоятельно добавлять новые функции

## Настройки конфигурации

### Параметры жестов
```autohotkey
gestureTimeWindow := 1000  ; Временное окно распознавания жеста в миллисекундах
minDistance := 50          ; Минимальное расстояние перемещения в пикселях
maxPause := 300            ; Максимальная пауза между движениями
menuTimeout := 3000        ; Автозакрытие меню через 3 секунды
```

### Настройки горячих клавиш
```
oskToggleHotkey := "#^o"   ; Win+Ctrl+O — переключение видимости экранных клавиатур
mouseJumpHotkey := "#+d"   ; Win+Shift+D
crosshairHotkey := "#!p"   ; Win+Alt+P
```

### Установка (протестировано с AutoHotkey v2.0 и PowerToys 0.94)

```
Установите AutoHotkey v2.0
Установите PowerToys 0.94
Сохраните скрипт с расширением .ahk
Запустите скрипт
```

### Использование

```
Базовый жест
Выполните движение мыши ВЛЕВО (> 50 пикселей)
Немедленно выполните движение ВПРАВО (> 50 пикселей)
Весь жест должен быть завершён в течение 1000 мс
```

### Опции панели быстрого доступа
```
osk hide/show: Переключение видимости экранных клавиатур
osk to cursor: Перемещение экранных клавиатур к курсору и фокусировка
mouse jump: Мгновенный переход указателя мыши в любую точку экрана
crosshair: Переключение прицельной сетки
Cancel: Закрыть меню
```

### Технические детали
```
Скрипт использует конечный автомат для отслеживания движений мыши:
Состояние 0: Ожидание начального движения
Состояние 1: Обнаружено движение влево
Состояние 2: Движение вправо завершает жест
```


### Кастомизация
```
Измените секцию конфигурации для:
Настройки чувствительности жестов (minDistance, maxPause)
Изменения длительности таймаута меню (menuTimeout, countdownTime)
```

### Примечания
```
Скрипт автоматически определяет, запущена ли экранные клавиатуры
Все элементы интерфейса корректно уничтожаются для предотвращения утечек памяти
```

